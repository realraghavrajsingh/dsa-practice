<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#6366f1" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="LeetCode DSA">
  <title>LeetCode DSA Problems | FAANG & Google-Style</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/svg+xml" href="/icon.svg">
  <link rel="apple-touch-icon" href="/icon.svg">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['JetBrains Mono', 'Fira Code', 'monospace'],
          },
          animation: {
            'fade-in': 'fadeIn 0.3s ease-out',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0', transform: 'translateY(-8px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
          },
        },
      },
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
  <style>
    .prose-pre { white-space: pre-wrap; word-break: break-word; }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .dark .gradient-bg { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); }
    .code-block-wrapper { position: relative; }
    .code-block-wrapper pre { margin: 0; border-radius: 0 0 0.5rem 0.5rem; max-height: 400px; overflow: auto; }
    .code-block-header { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 1rem; background: #2d3748; color: #a0aec0; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace; border-radius: 0.5rem 0.5rem 0 0; }
    .dark .code-block-header { background: #1a202c; }
    .copy-btn { padding: 0.25rem 0.5rem; border-radius: 0.25rem; background: #4a5568; color: white; font-size: 0.7rem; cursor: pointer; transition: all 0.2s; border: none; }
    .copy-btn:hover { background: #6366f1; }
    .copy-btn.copied { background: #10b981; }
    .card { transition: transform 0.2s, box-shadow 0.2s; }
    .card:hover { transform: translateY(-2px); box-shadow: 0 10px 40px -10px rgba(99, 102, 241, 0.25); }
    .dark .card:hover { box-shadow: 0 10px 40px -10px rgba(99, 102, 241, 0.4); }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100 min-h-screen font-sans antialiased transition-colors duration-200">
  <div id="app" class="min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-50 border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl gradient-bg flex items-center justify-center text-white font-bold shadow-lg">LC</div>
            <div>
              <h1 class="text-lg font-bold">LeetCode DSA</h1>
              <p class="text-xs text-gray-500 dark:text-gray-400">FAANG & Google-Style</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <button id="theme-toggle" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" title="Toggle theme">
              <svg class="w-5 h-5 dark:hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/></svg>
              <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/></svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Search & Filters -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col sm:flex-row gap-4 mb-6">
        <div class="flex-1 relative">
          <input type="text" id="search" placeholder="Search problems... (e.g. Two Sum, array, LC001)" 
            class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
          <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
        </div>
        <div class="flex flex-wrap gap-2">
          <select id="difficulty-filter" class="px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 focus:ring-2 focus:ring-indigo-500">
            <option value="">All Difficulties</option>
            <option value="Easy">Easy</option>
            <option value="Medium">Medium</option>
            <option value="Hard">Hard</option>
          </select>
          <select id="type-filter" class="px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 focus:ring-2 focus:ring-indigo-500 min-w-[200px]">
            <option value="">All Types</option>
          </select>
          <select id="sort-by" class="px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 focus:ring-2 focus:ring-indigo-500">
            <option value="number">Sort: Number</option>
            <option value="difficulty">Sort: Difficulty</option>
            <option value="type">Sort: Type</option>
          </select>
        </div>
      </div>

      <!-- Stats -->
      <div id="stats" class="mb-6 flex flex-wrap gap-4 text-sm text-gray-500 dark:text-gray-400">
        <span>Showing <span id="count">0</span> of <span id="total">0</span> problems</span>
        <span id="progress-stats" class="text-green-600 dark:text-green-400 font-medium"></span>
      </div>

      <!-- Problem Grid -->
      <div id="problems-grid" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
        <!-- Cards rendered by JS -->
      </div>

      <div id="empty-state" class="hidden text-center py-16 text-gray-500 dark:text-gray-400">
        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <p class="text-lg">No problems match your filters.</p>
        <p class="text-sm mt-2">Try adjusting your search or filters.</p>
      </div>
    </div>
  </div>

  <!-- Problem Detail Modal -->
  <div id="modal" class="fixed inset-0 z-[100] hidden">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeModal()"></div>
    <div class="absolute inset-4 sm:inset-8 md:inset-8 lg:inset-8 overflow-auto">
      <div class="max-w-4xl mx-auto bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 overflow-hidden animate-fade-in">
        <div class="sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-6 py-4 flex items-center justify-between">
          <h2 id="modal-title" class="text-xl font-bold"></h2>
          <button onclick="closeModal()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
          </button>
        </div>
        <div id="modal-content" class="p-6 prose dark:prose-invert max-w-none">
          <!-- Content -->
        </div>
      </div>
    </div>
  </div>

  <script>
    let problems = [];
    let types = new Set();

    // Theme
    const themeToggle = document.getElementById('theme-toggle');
    if (localStorage.theme === 'dark' || (!localStorage.theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    themeToggle?.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    });

    // Load problems
    fetch('/problems.json')
      .then(r => r.json())
      .then(data => {
        problems = data;
        problems.forEach(p => {
          (p.type || '').split(',').forEach(t => t.trim() && types.add(t.trim()));
        });
        const typeSelect = document.getElementById('type-filter');
        [...types].sort().forEach(t => {
          const opt = document.createElement('option');
          opt.value = t;
          opt.textContent = t;
          typeSelect.appendChild(opt);
        });
        document.getElementById('total').textContent = problems.length;
        updateProgressStats();
        render();
      })
      .catch(err => {
        document.getElementById('problems-grid').innerHTML = 
          '<div class="col-span-full text-center py-16 text-red-500">Failed to load problems. Run: python3 scripts/extract_problems.py</div>';
      });

    function getSolved() {
      try {
        return new Set(JSON.parse(localStorage.getItem('solved') || '[]'));
      } catch { return new Set(); }
    }
    function setSolved(numbers) {
      localStorage.setItem('solved', JSON.stringify([...numbers]));
    }
    function toggleSolved(number) {
      const s = getSolved();
      if (s.has(number)) s.delete(number);
      else s.add(number);
      setSolved(s);
      updateProgressStats();
      render();
      if (document.getElementById('modal') && !document.getElementById('modal').classList.contains('hidden')) {
        openModal(number);
      }
    }
    function updateProgressStats() {
      const s = getSolved();
      const el = document.getElementById('progress-stats');
      if (s.size > 0) el.textContent = `✓ ${s.size} solved`;
      else el.textContent = '';
    }
    function sortProblems(list) {
      const order = document.getElementById('sort-by').value;
      const arr = [...list];
      if (order === 'number') arr.sort((a, b) => (a.number || '').localeCompare(b.number || ''));
      else if (order === 'difficulty') {
        const ord = { Easy: 0, Medium: 1, Hard: 2 };
        arr.sort((a, b) => (ord[a.difficulty] ?? 3) - (ord[b.difficulty] ?? 3) || (a.number || '').localeCompare(b.number || ''));
      }
      else if (order === 'type') arr.sort((a, b) => (a.type || '').localeCompare(b.type || '') || (a.number || '').localeCompare(b.number || ''));
      return arr;
    }
    function filterProblems() {
      const search = document.getElementById('search').value.toLowerCase();
      const difficulty = document.getElementById('difficulty-filter').value;
      const type = document.getElementById('type-filter').value;

      return problems.filter(p => {
        const matchSearch = !search || 
          (p.title || '').toLowerCase().includes(search) ||
          (p.number || '').toLowerCase().includes(search) ||
          (p.type || '').toLowerCase().includes(search) ||
          (p.tags || []).some(t => t.toLowerCase().includes(search));
        const matchDiff = !difficulty || p.difficulty === difficulty;
        const matchType = !type || (p.type || '').includes(type);
        return matchSearch && matchDiff && matchType;
      });
    }

    function render() {
      const filtered = filterProblems();
      document.getElementById('count').textContent = filtered.length;
      const grid = document.getElementById('problems-grid');
      const empty = document.getElementById('empty-state');

      if (filtered.length === 0) {
        grid.innerHTML = '';
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');

      const solved = getSolved();
      const sorted = sortProblems(filtered);
      grid.innerHTML = sorted.map(p => `
        <div class="card p-5 rounded-xl border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 hover:border-indigo-300 dark:hover:border-indigo-700 transition-all cursor-pointer group shadow-sm relative" onclick='openModal("${p.number}")'>
          ${solved.has(p.number) ? '<span class="absolute top-3 right-3 text-green-500" title="Solved">✓</span>' : ''}
          <div class="flex items-start justify-between gap-2 mb-2">
            <span class="text-xs font-mono font-medium text-indigo-600 dark:text-indigo-400">${p.number}</span>
            <span class="badge px-2 py-0.5 rounded-full text-xs font-medium ${getDifficultyClass(p.difficulty)}">${p.difficulty}</span>
          </div>
          <h3 class="font-semibold text-gray-900 dark:text-gray-100 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors mb-2">${escapeHtml(p.title)}</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 line-clamp-2">${escapeHtml(p.type || '')}</p>
          <div class="flex items-center gap-2 mt-2 flex-wrap">
            ${p.time ? `<span class="text-xs font-mono text-gray-400 dark:text-gray-500">${escapeHtml(p.time)}</span>` : ''}
            ${p.javaCode ? `<span class="text-xs px-2 py-0.5 rounded bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400">Java</span>` : ''}
          </div>
        </div>
      `).join('');
    }

    function getDifficultyClass(d) {
      if (d === 'Easy') return 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400';
      if (d === 'Medium') return 'bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400';
      if (d === 'Hard') return 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400';
      return '';
    }

    function escapeHtml(s) {
      if (!s) return '';
      const div = document.createElement('div');
      div.textContent = s;
      return div.innerHTML;
    }

    function openModal(number) {
      const p = problems.find(x => x.number === number);
      if (!p) return;
      const modal = document.getElementById('modal');
      const title = document.getElementById('modal-title');
      const content = document.getElementById('modal-content');

      title.textContent = `${p.number}: ${p.title}`;
      const codeId = 'modal-code-' + Date.now();
      const solved = getSolved();
      const leetcodeUrl = p.leetcodeSlug ? `https://leetcode.com/problems/${p.leetcodeSlug}/` : null;
      content.innerHTML = `
        <div class="space-y-6">
          <div class="flex flex-wrap gap-2 items-center">
            <span class="badge px-3 py-1 rounded-full text-sm font-medium ${getDifficultyClass(p.difficulty)}">${p.difficulty}</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">${escapeHtml(p.type || '')}</span>
            ${p.time || p.space ? `<span class="text-xs font-mono text-gray-400">${escapeHtml(p.time || '')} | ${escapeHtml(p.space || '')}</span>` : ''}
            ${leetcodeUrl ? `<a href="${leetcodeUrl}" target="_blank" rel="noopener" class="ml-auto text-sm text-indigo-600 dark:text-indigo-400 hover:underline flex items-center gap-1">Open on LeetCode ↗</a>` : ''}
            <button onclick="toggleSolved('${p.number}'); event.stopPropagation();" class="px-3 py-1 rounded-lg text-sm font-medium ${solved.has(p.number) ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400' : 'bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400'} hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors">
              ${solved.has(p.number) ? '✓ Solved' : 'Mark Solved'}
            </button>
          </div>
          ${p.statement ? `<div><h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2">Problem Statement</h3><p class="text-gray-600 dark:text-gray-300 leading-relaxed">${escapeHtml(p.statement)}</p></div>` : ''}
          ${p.constraints ? `<div><h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2">Constraints</h3><p class="text-gray-600 dark:text-gray-300">${escapeHtml(p.constraints)}</p></div>` : ''}
          ${p.examples ? `<div><h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2">Examples</h3><pre class="prose-pre p-4 rounded-lg bg-gray-100 dark:bg-gray-800 text-sm font-mono overflow-x-auto border border-gray-200 dark:border-gray-700">${escapeHtml(p.examples)}</pre></div>` : ''}
          ${p.approach ? `<div><h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2">Approach</h3><p class="text-gray-600 dark:text-gray-300">${escapeHtml(p.approach)}</p></div>` : ''}
          ${p.javaCode ? (() => {
            const code = (p.javaCode || '').replace(/^package\s+[\w.]+;\s*\n?/, '');
            return `
          <div>
            <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2">Java Solution</h3>
            <div class="code-block-wrapper rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700">
              <div class="code-block-header">
                <span>Solution.java</span>
                <button class="copy-btn" onclick="copyCode('${codeId}', this)">Copy</button>
              </div>
              <pre class="language-java"><code id="${codeId}">${escapeHtml(code)}</code></pre>
            </div>
          </div>
          `;
          })() : ''}
        </div>
      `;
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
      if (window.Prism && p.javaCode) Prism.highlightAllUnder(content);
      updateProgressStats();
    }

    function closeModal() {
      document.getElementById('modal').classList.add('hidden');
      document.body.style.overflow = '';
    }

    function copyCode(id, btn) {
      const el = document.getElementById(id);
      if (!el) return;
      navigator.clipboard.writeText(el.textContent).then(() => {
        btn.textContent = 'Copied!';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
      });
    }

    document.getElementById('search').addEventListener('input', render);
    document.getElementById('search').addEventListener('keyup', e => e.key === 'Escape' && (e.target.value = '') && render());
    document.getElementById('difficulty-filter').addEventListener('change', render);
    document.getElementById('type-filter').addEventListener('change', render);
    document.getElementById('sort-by').addEventListener('change', render);
    document.addEventListener('keydown', e => e.key === 'Escape' && closeModal());
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
</body>
</html>
